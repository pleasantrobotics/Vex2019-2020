/* Finally */


/* top-level */
#include "robot-config.h"
using namespace vex;

/* CONTROLLER 1 - DRIVE */
int main() {
    
    while(1) {
        
        /* cosmetics */
        if (Brain.Battery.capacity() < 10) {
            Brain.Screen.setOrigin(125,100);
            Brain.Screen.setFont(fontType::prop40);
            Brain.Screen.print("LOW BATTERY!");
        }
        else {
            Brain.Screen.setOrigin(100,100);
            Brain.Screen.setFont(fontType::prop30);
            Brain.Screen.print("Battery percentage: ");
            Brain.Screen.print(Brain.Battery.capacity());
        }
        
        /* drive motor control */
        Left.spin(directionType::fwd, (Controller1.Axis3.value() + Controller1.Axis1.value())/2, velocityUnits::pct);
        Right.spin(directionType::rev, (Controller1.Axis4.value() - Controller1.Axis2.value())/2, velocityUnits::pct);
        FLeft.spin(directionType::fwd, (Controller1.Axis3.value() + Controller1.Axis1.value())/2, velocityUnits::pct);
        FRight.spin(directionType::rev, (Controller1.Axis4.value() - Controller1.Axis2.value())/2, velocityUnits::pct);
        
        /* rumble */
        if(Controller1.ButtonY.pressing() == true){
            Controller1.rumble("-");
            Controller2.rumble("-");
        }

        if(Controller2.ButtonY.pressing() == true) {
            Controller1.rumble("-");
            Controller2.rumble("-");
        }
        
        /* middle motor control */
        if(Controller1.ButtonLeft.pressing() == true){
            Middle.spin(directionType::fwd, 100, velocityUnits::pct);
        }
        else if(Controller1.ButtonRight.pressing() == true){
            Middle.spin(directionType::rev, 100, velocityUnits::pct);
        }
        else {
            Middle.stop();
            
        /* arm control (CONTROLLER 2) */ 
        if(Controller2.ButtonR2.pressing() == true) {
            LeftA.spin(directionType::rev, 50, velocityUnits::pct);
            RightA.spin(directionType::rev, 50, velocityUnits::pct);
        }
            
        else if(Controller2.ButtonR1.pressing() == true) {
            LeftA.spin(directionType::fwd, 50, velocityUnits::pct);
            RightA.spin(directionType::fwd, 50, velocityUnits::pct);
        }
            
        else {
            LeftA.stop(hold);
            RightA.stop(hold);
        }
        
        /* grab motor control */
        if(Controller2.ButtonDown.pressing() == true){
            Grab.spin(directionType::rev, 50, velocityUnits::pct);
        }
        else if(Controller2.ButtonUp.pressing() == true){
            Grab.spin(directionType::fwd, 50, velocityUnits::pct);
        }
        else {
            Grab.stop();
        }
        
        task::sleep(20);
    }
}
}

/**************************************************/
/*                  Robot-Config                  */
/**************************************************/

using namespace vex;

brain Brain;

motor Left = motor(PORT2, gearSetting::ratio18_1, false);
motor Right = motor(PORT1, gearSetting::ratio18_1, true);
motor FLeft = motor(PORT4, gearSetting::ratio18_1, false);
motor FRight = motor(PORT5, gearSetting::ratio18_1, true);
motor Middle = motor(PORT3, gearSetting::ratio18_1, true);
motor LeftA = motor(PORT12, gearSetting::ratio36_1, false);
motor RightA = motor(PORT11, gearSetting::ratio36_1, true);
motor Grab = motor(PORT8, gearSetting::ratio18_1, true);

controller Controller1 = controller(controllerType::primary);
controller Controller2 = controller(controllerType::partner);
